

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Monitoring &mdash; Paramore 7.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Feature Switches" href="FeatureSwitches.html" />
    <link rel="prev" title="Building a Pipeline of Async Request Handlers" href="BuildingAnAsyncPipeline.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Paramore
          

          
          </a>

          
            
            
              <div class="version">
                7.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ImplementingAHandler.html">How to Implement a Request Handler</a></li>
<li class="toctree-l1"><a class="reference internal" href="DispatchingARequest.html">Dispatching Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildingAPipeline.html">Building a Pipeline of Request Handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildingAPipeline.html#the-pipes-and-filters-architectural-style">The Pipes and Filters Architectural Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildingAPipeline.html#the-russian-doll-model">The Russian Doll Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildingAPipeline.html#implementing-a-pipeline">Implementing a Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildingAPipeline.html#using-a-manual-approach">Using a Manual Approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingTheContextBag.html">Passing information between Handlers in the Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="PolicyRetryAndCircuitBreaker.html">Supporting Retry and Circuit Breaker</a></li>
<li class="toctree-l1"><a class="reference internal" href="PolicyRetryAndCircuitBreaker.html#using-brighter-s-usepolicy-attribute">Using Brighter’s UsePolicy Attribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="PolicyRetryAndCircuitBreaker.html#timeout">Timeout</a></li>
<li class="toctree-l1"><a class="reference internal" href="PolicyFallback.html">Failure and Fallback</a></li>
<li class="toctree-l1"><a class="reference internal" href="EventSourcing.html">Event Sourcing</a></li>
<li class="toctree-l1"><a class="reference internal" href="EventSourcing.html#command-or-event-sourcing">Command or Event Sourcing</a></li>
<li class="toctree-l1"><a class="reference internal" href="EventSourcing.html#command-sourcing-in-brighter">Command Sourcing in Brighter</a></li>
<li class="toctree-l1"><a class="reference internal" href="BasicConfiguration.html">Basic Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="BasicConfiguration.html#what-you-need-to-provide">What you need to provide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Logging.html">Supporting Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="ImplementingDistributedTaskQueue.html">Implementing a Distributed Task Queue</a></li>
<li class="toctree-l1"><a class="reference internal" href="ImplementingDistributedTaskQueue.html#brighter-s-task-queue-architecture">Brighter’s Task Queue Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="ImplementingDistributedTaskQueue.html#do-i-have-to-use-a-broker-what-about-msmq">Do I have to use a Broker, what about MSMQ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="ImplementingDistributedTaskQueue.html#what-happens-when-the-consumer-receives-the-message">What happens when the consumer receives the message?</a></li>
<li class="toctree-l1"><a class="reference internal" href="ImplementingDistributedTaskQueue.html#what-does-this-look-like-in-code">What does this look like in code</a></li>
<li class="toctree-l1"><a class="reference internal" href="ImplementingDistributedTaskQueue.html#the-dispatcher">The Dispatcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="ImplementingDistributedTaskQueue.html#configuration">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Routing.html">Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="DistributedTaskQueueConfiguration.html">Distributed Task Queue Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="DistributedTaskQueueConfiguration.html#configuring-the-dispatcher-in-code">Configuring the Dispatcher in Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="RabbitMQConfiguration.html">RabbitMQ Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="RunningUnderAWSSQSInfrastructure.html">Running Brighter under AWS SQS Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="AWSSQSConfiguration.html">AWS SQS Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="AsyncDispatchARequest.html">Dispatching Requests Asynchronously</a></li>
<li class="toctree-l1"><a class="reference internal" href="ImplementingAsyncHandler.html">How to Implement an Asynchronous Request Handler</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildingAnAsyncPipeline.html">Building a Pipeline of Async Request Handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="BuildingAnAsyncPipeline.html#implementing-a-pipeline">Implementing a Pipeline</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Monitoring</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuring-monitoring">Configuring Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="#config-file">Config file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#handler-confguration">Handler confguration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#attribute">Attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="#container-registration">Container registration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#monitor-message-format">Monitor message format</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="FeatureSwitches.html">Feature Switches</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frquently Asked Questions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Paramore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Monitoring</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Monitoring.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="monitoring">
<h1>Monitoring<a class="headerlink" href="#monitoring" title="Permalink to this headline">¶</a></h1>
<p>Brighter emits monitoring information from Task Queues using a
configured <a class="reference external" href="https://brightercommand.github.io/Brighter/ControlBus.html">Control Bus</a>     // failing link</p>
<div class="section" id="configuring-monitoring">
<h2>Configuring Monitoring<a class="headerlink" href="#configuring-monitoring" title="Permalink to this headline">¶</a></h2>
<p>Firstly <a class="reference external" href="https://brightercommand.github.io/Brighter/ControlBus.html#configure">configure a Control Bus</a> in the   // failing link
brighter application to emit monitoring messages</p>
</div>
<div class="section" id="config-file">
<h2>Config file<a class="headerlink" href="#config-file" title="Permalink to this headline">¶</a></h2>
<p>Monitoring requires a new section to be added to the application config
file:</p>
<p>// config with XML???</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;configSections&gt;</span>
    <span class="nt">&lt;section</span> <span class="na">name=</span><span class="s">&quot;monitoring&quot;</span> <span class="na">type =</span><span class="s">&quot;paramore.brighter.commandprocessor.monitoring.Configuration.MonitoringConfigurationSection, Brighter.commandprocessor&quot;</span> <span class="na">allowLocation =</span><span class="s">&quot;true&quot;</span> <span class="na">allowDefinition=</span><span class="s">&quot;Everywhere&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/configSections&gt;</span>
</pre></div>
</div>
<p>The monitoring config can then be speicified later in the file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;monitoring&gt;</span>
    <span class="nt">&lt;monitor</span> <span class="na">isMonitoringEnabled=</span><span class="s">&quot;true&quot;</span> <span class="na">instanceName=</span><span class="s">&quot;ManagementAndMonitoring&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/monitoring&gt;</span>
</pre></div>
</div>
<p>This enables runtime changes to enable/disable emitting of monitoring
messages.</p>
</div>
<div class="section" id="handler-confguration">
<h2>Handler confguration<a class="headerlink" href="#handler-confguration" title="Permalink to this headline">¶</a></h2>
<p>Each handler that requires monitoring must be configured in two stages,
a Handler attribute and container registration of a MonitorHandler for
the given request:</p>
<p>For example, given:</p>
<ul class="simple">
<li>TRequest - a Brighter Request, inheriting from IRequest</li>
<li>TRequestHandler - handles the TRequest, inheriting IHandleRequest
&lt;TRequest&gt;</li>
</ul>
<div class="section" id="attribute">
<h3>Attribute<a class="headerlink" href="#attribute" title="Permalink to this headline">¶</a></h3>
<p>The following attribute must be added to the Handle method in the
handler, TRequestHandler:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="na">[Monitor(step:1, timing:HandlerTiming.Before, handlerType:typeof(TRequestHandler))]</span>
</pre></div>
</div>
<p>Please note the step and timing can vary if monitoring should be after
another attribute step, or timing should be emitted after.</p>
</div>
<div class="section" id="container-registration">
<h3>Container registration<a class="headerlink" href="#container-registration" title="Permalink to this headline">¶</a></h3>
<p>The following additional handler must be registered in the application
container (where <code class="docutils literal notranslate"><span class="pre">MonitorHandler&lt;T&gt;</span></code> is a built-in Brighter handler):</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">container</span><span class="p">.</span><span class="n">Register</span><span class="p">&lt;</span><span class="n">TRequest</span><span class="p">,</span> <span class="n">MonitorHandler</span><span class="p">&lt;</span><span class="n">TRequest</span><span class="p">&gt;&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="monitor-message-format">
<h2>Monitor message format<a class="headerlink" href="#monitor-message-format" title="Permalink to this headline">¶</a></h2>
<p>A message is emitted from the Control Bus on Handler Entry and Handler
Exit. The following is the form of the message:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;Exception&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> <span class="c1">// or Exception message</span>
    <span class="s2">&quot;EventType&quot;</span><span class="o">:</span> <span class="s2">&quot;EnterHandler or ExitHandler&quot;</span><span class="p">,</span>
    <span class="s2">&quot;EventTime&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-06-21T15:48:26.1390192Z&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TimeElapsedMs&quot;</span><span class="o">:</span> <span class="mi">0</span> <span class="nx">or</span> <span class="nx">Duration</span><span class="p">,</span>
    <span class="s2">&quot;HandlerName&quot;</span><span class="o">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HandlerFullAssemblyName&quot;</span><span class="o">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;InstanceName&quot;</span><span class="o">:</span> <span class="s2">&quot;ManagementAndMonitoring&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RequestBody&quot;</span><span class="o">:</span> <span class="s2">&quot;{\&quot;Id\&quot;:\&quot;dc32b35f-bc75-4197-9178-c8310a63e4fb\&quot;, ... }&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Id&quot;</span><span class="o">:</span> <span class="s2">&quot;048cc207-e820-40fa-b931-55b60203fbc2&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Messages can be processed from the queue and interated with your
monitoring tool of choice, for example Live python consumers emitting to
console or logstash consumption to the ELK stack using relevant plugins
to provide performance raditators or dashboards.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="FeatureSwitches.html" class="btn btn-neutral float-right" title="Feature Switches" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="BuildingAnAsyncPipeline.html" class="btn btn-neutral" title="Building a Pipeline of Async Request Handlers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Ian Cooper

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>